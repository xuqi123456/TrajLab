package whu.edu.cn.trajlab.query.util;

import whu.edu.cn.trajlab.base.point.TrajPoint;
import whu.edu.cn.trajlab.base.trajectory.Trajectory;
import whu.edu.cn.trajlab.base.util.SerializerUtils;
import whu.edu.cn.trajlab.query.coprocessor.autogenerated.QueryCondition;

import java.io.IOException;
import java.util.List;

/**
 * @author xuqi
 * @date 2024/01/16
 */
public class TrajectoryUtils {
    public static Trajectory protoResultToTrajectory(QueryCondition.TrajectoryResult tr)
            throws IOException {
        byte[] trajPointByteArray = tr.getTrajPointList().toByteArray();
        byte[] objectID = tr.getObjectId().toByteArray();
        byte[] tID = tr.getTid().toByteArray();
        List<TrajPoint> trajPointList = SerializerUtils.deserializeList(trajPointByteArray,
                TrajPoint.class);
        String objectStr = (String) SerializerUtils.deserializeObject(objectID, String.class);
        String tidStr = (String) SerializerUtils.deserializeObject(tID, String.class);
        return new Trajectory(tidStr, objectStr, trajPointList);
    }
}
